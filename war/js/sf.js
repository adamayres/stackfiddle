/**
 * Stack Fiddle
 *    https://github.com/adamayres/jqueryplugins/tree/master/stack-fiddle
 *  
 * Copyright (c) 2011, Adam Ayres 
 * 
 * Licensed under the MIT license:
 *    https://github.com/adamayres/jqueryplugins/raw/master/MIT-LICENSE.txt
 *
 * Mon Mar 14 04:31:54 PDT 2011
 */
(function(){var a=function(){var a,b,c,d,e,f,g="http://jsfiddle.net/api/post",h=g+"/mootools/1.3.1/",i="<div id='sf-wrapper'><div id='sf-header'><div id='sf-close'><a href='#' class='simplemodal-close'>close</a></div><div id='sf-title'>Stack Fiddle It!</div></div><div id='sf-feedback'>Loading...</div><div id='sf-content'><form id='sf-form' method='post' action='"+h+"'>"+"<div id='sf-code' />"+"<div class='sf-form-group'>"+"<label for='sf-frameworks'>Framework</label>"+"<select id='sf-frameworks'><option>Loading...</option></select>"+"</div>"+"<input type='submit' value='Fiddle It!' id='sf-submit' />"+"</form>"+"</div>"+"</div>",j="<div class='sf-form-group'><label class='sf-code-label' /><textarea /><input type='radio' value='html' id='sf-code-html' /><label for='sf-code-html' id='sf-code-html'>HTML</label><input type='radio' value='css' id='sf-code-css' /><label for='sf-code-css' id='sf-code-css'>CSS</label><input type='radio' value='js' id='sf-code-js' /><label for='sf-code-js' id='sf-code-js'>JS</label><input type='radio' value='none' id='sf-code-none' /><label for='sf-code-none' id='sf-code-none'>None</label><a href='#' class='sf-show-more'>Show More</a></div>",k=function(){var a=5297586,b=window.location.pathname.split("/");for(var c=0;c<b.length;c++)b[c]=="questions"&&c+1<b.length&&(a=b[c+1]);return a},l=function(){$.ajax({url:"http://api.stackoverflow.com/1.1/questions/"+k()+"?body=true",dataType:"jsonp",jsonp:"jsonp",success:function(a){var b=a.questions[0].body,f=$(b).find("code");c.css({position:"absolute",left:-9999}).show(),f.each(function(a){var b=$(j),c=b.find("textarea"),e=b.find(".sf-show-more");c.html($(this).html()),b.find(".sf-code-label").html("Code Block "+(a+1)),b.find("input").each(function(){this.id=this.id+a,this.name="code"+a}),b.find("label").each(function(){$(this).attr("for",$(this).attr("for")+a)}),d.append(b),m(e,c)}),$(":input[type='radio']",c[0]).live("click",function(){var a=$(this),b=$(this).siblings("textarea");a.val()=="none"?b.attr("disabled","disabled"):(b.removeAttr("disabled"),b.attr("name",a.val()))}),c.submit(function(){var a={},b=c.find("textarea");$.each(["html","css","js"],function(a,d){var e=b.filter("[name='"+this+"']");if(e.size()>1){var f="";e.each(function(){var a=$(this);f+=a.val(),a.attr("disabled","disabled")});var g=$("<input>",{type:"hidden",name:d,value:f});c.append(g)}})});var g=c.height();c.height(0).css({position:"static",left:0}),c.animate({height:g},200),c.show(),e.text("Choose a content type for each code block")}})},m=function(a,b){var c=b.get(0),d=b.height();if(b.height()===c.scrollHeight){a.remove();while(b.height()===c.scrollHeight)b.height(b.height()-1);b.height(b.height()+2)}else a.click(function(){var a=$(this),e=c.scrollHeight,f=b.height(),g=f>=e?0:e-f,h=0;g>=100?h=f+100:g===0?h=d>f-100?d:f-100:h=f+g,b.animate({height:h},300,function(){b.height()>=e?a.html("Show Less"):a.html("Show More")});return!1})},n=function(a){var b="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fjsfiddle.net%22%20and%20xpath%3D%22%2F%2Fselect%5B%40id%3D'js_lib'%5D%22&diagnostics=true";$.ajax({url:b,dataType:"jsonp",success:function(a){var b=$(a.results[0]);b.find("option").each(function(){var a=$(this),b=a.text().replace(/[A-Za-z ()\-]*/g,"");b===""?a.remove():a.val("/"+a.closest("optgroup").attr("label")+"/"+b+"/")}),b.find("optgroup").each(function(){$(this).children().size()===0&&$(this).remove()}),f.replaceWith(b),b.change(function(){c.attr("action",g+b.val())})}})},o=function(a){a.overlay.fadeIn(200,function(){a.data.show(),a.container.css("height","auto"),a.container.fadeIn(200,function(){l()})})};return{init:function(){b=$(i),c=b.find("#sf-form").hide(),d=b.find("#sf-code"),e=b.find("#sf-feedback"),f=b.find("#sf-frameworks"),n(),a=b.modal({closeHTML:null,overlayId:"sf-overlay",containerId:"sf-container",opacity:10,position:["30px"],onOpen:o})}}}(),b=function(){var b=document.head||document.getElementsByTagName("head")[0]||document.documentElement,c=function(a,b){var c=!1,d=a.split("."),e=b.split(".");for(var f=0;f<e.length;f++){if(d[f]>e[f]){c=!0;break}d[f]==e[f]?c=!0:c=!1}return c},d=function(a,c){var d=function(a,c){a.onload=a.onreadystatechange=function(d,e){if(!a.readyState||/loaded|complete/.test(a.readyState))a.onload=a.onreadystatechange=null,!b||!a.parentNode,a=undefined,c()},b.insertBefore(a,b.firstChild)};return{js:function(a,b){var c=document.createElement("script");c.setAttribute("async","async"),c.setAttribute("src",a),c.setAttribute("type","text/javascript"),d(c,b)},css:function(a,b){var c=document.createElement("link");c.setAttribute("href",a),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),d(c,b)}}}();d.css("http://stackfiddle.com/css/sf.css",function(){});var e=function(){d.js("http://stackfiddle.com/js/jquery.simplemodal.js",a.init)};window.hasOwnProperty("jQuery")&&jQuery.fn.jquery&&c(window.jQuery.fn.jquery,"1.4.4")?e():d.js("http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js",e)}()})()