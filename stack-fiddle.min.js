/**
 * Stack Fiddle
 *    https://github.com/adamayres/stackfiddle/
 *  
 * Copyright (c) 2011, Adam Ayres 
 * 
 * Licensed under the MIT license:
 *    https://github.com/adamayres/stackfiddle/raw/master/MIT-LICENSE.txt
 *
 * Sat Dec 17 21:00:25 PST 2011
 */
(function(){var a=function(){var a,b,c,d,e,f,g,h="http://jsfiddle.net/api/post",i=h+"/mootools/1.3.2/",j="<div id='sf-wrapper'><div id='sf-header'><div id='sf-close'><a href='#' class='simplemodal-close'>close</a></div><div id='sf-title'>Stack Fiddle It!</div></div><div id='sf-feedback'>Loading...</div><div id='sf-content'><form id='sf-form' method='post' action='"+i+"' target='_blank'>"+"<div id='sf-code' />"+"<div class='sf-form-group'>"+"<label for='sf-frameworks'>Framework</label>"+"<select id='sf-frameworks'><option>Loading...</option></select>"+"</div>"+"<input type='submit' value='Fiddle It!' id='sf-submit' />"+"</form>"+"</div>"+"</div>",k="<div class='sf-form-group'><label class='sf-code-label' /><textarea /><input type='radio' value='html' id='sf-code-html' /><label for='sf-code-html'>HTML</label><input type='radio' value='css' id='sf-code-css' /><label for='sf-code-css'>CSS</label><input type='radio' value='js' id='sf-code-js' /><label for='sf-code-js'>JS</label><input type='radio' value='none' id='sf-code-none' /><label for='sf-code-none'>None</label><div class='sf-show-container'><a href='#' class='sf-show-more sf-show'>More</a> | <a href='#' class='sf-show-less sf-show'>Less</a></div></div>",l=function(){var a=5365997,b=window.location.pathname.split("/");for(var c=0;c<b.length;c++)b[c]=="questions"&&c+1<b.length&&(a=b[c+1]);return a},m=function(){$.ajax({url:"http://api.stackoverflow.com/1.1/questions/"+l()+"?body=true",dataType:"jsonp",jsonp:"jsonp",success:function(f){var h=f.questions[0].body,i=$(h).find("code");c.css({position:"absolute",left:-9999}).show(),i.each(function(a){var b=$(k),c=b.find("textarea"),e=b.find(".sf-show-more"),f=b.find(".sf-show-less");c.html($(this).html()),b.find(".sf-code-label").html("Code Block "+(a+1)),b.find("input").each(function(){this.id=this.id+a,this.name="code"+a}),b.find("label").each(function(){$(this).attr("for",$(this).attr("for")+a)}),d.append(b),n(f,e,c),b.hover(function(){g.eq(a).addClass("sf-highlight")},function(){g.eq(a).removeClass("sf-highlight")})}),$(":input[type='radio']",c[0]).live("click",function(){var a=$(this),b=$(this).siblings("textarea");a.val()=="none"?b.attr("disabled","disabled"):(b.removeAttr("disabled"),b.attr("name",a.val()))}),c.submit(function(){var b={},d=c.find("textarea");$.each(["html","css","js"],function(a,b){var e=d.filter("[name='"+this+"']");if(e.size()>1){var f="";e.each(function(){var a=$(this);f+=a.val(),a.attr("disabled","disabled")});var g=$("<input>",{type:"hidden",name:b,value:f});c.append(g)}}),setTimeout(function(){a.close()},300)});var j=c.outerHeight();c.height(0).css({position:"static",left:0}).hide(),b.animate({height:j},200,function(){b.css("height","auto"),c.fadeIn(200)}),e.text("Choose a content type for each code block")}})},n=function(a,b,c){var d=c.get(0),e=c.height();if(c.height()===d.scrollHeight){while(c.height()===d.scrollHeight)c.height(c.height()-1);c.height(c.height()+2)}b.click(function(){c.animate({height:"+=100px"},200);return!1}),a.click(function(){c.animate({height:c.height()<=100?10:"-=100px"},200);return!1})},o=function(a){var b="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fjsfiddle.net%22%20and%20xpath%3D%22%2F%2Fselect%5B%40id%3D'js_lib'%5D%22&diagnostics=true";$.ajax({url:b,dataType:"jsonp",success:function(a){var b=$(a.results[0]);b.find("option").each(function(){var a=$(this),b=a.text().replace(/[A-Za-z ()\-]*/g,"");b===""?a.remove():a.val("/"+a.closest("optgroup").attr("label")+"/"+b+"/")}),b.find("optgroup").each(function(){$(this).children().size()===0&&$(this).remove()}),f.replaceWith(b),b.change(function(){c.attr("action",h+b.val())})}})},p=function(a){a.overlay.fadeIn(200,function(){a.data.show(),a.container.css({height:"auto",top:"30px",right:"30px",left:"auto",position:"absolute"}),a.container.fadeIn(200,function(){m()})})},q=function(b){window.sfopen=!1,a.close()};return{init:function(){$("#sf-loader").remove(),window.sfopen!==!0&&(window.sfopen=!0,b=$(j),c=b.find("#sf-form").hide(),d=b.find("#sf-code"),e=b.find("#sf-feedback"),f=b.find("#sf-frameworks"),g=$("#question").find("code").map(function(){codeParent=$(this).parent("pre");return codeParent.size()>0?codeParent.get():this}),o(),a=b.modal({closeHTML:null,overlayId:"sf-overlay",containerId:"sf-container",opacity:10,minWidth:350,autoPosition:!1,onOpen:p,onClose:q}))}}}(),b=function(){var b=document.head||document.getElementsByTagName("head")[0]||document.documentElement,c=function(a,b){var c=!1,d=a.split("."),e=b.split(".");for(var f=0;f<e.length;f++){if(d[f]>e[f]){c=!0;break}d[f]==e[f]?c=!0:c=!1}return c},d=function(){var a={},c=function(c,d,e){a.hasOwnProperty(c)||(a[c]=!1,d.onload=d.onreadystatechange=function(f,g){a[c]=!0;if(!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,!b||!d.parentNode,d=undefined,typeof e=="function"&&e()},b.insertBefore(d,b.firstChild))};return{js:function(a,b){var d=document.createElement("script");d.setAttribute("async","async"),d.setAttribute("src",a),d.setAttribute("type","text/javascript"),c(a,d,b)},css:function(a){var b=document.createElement("link");b.setAttribute("href",a),b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css"),c(a,b)},loaded:function(b){return a[b]||!1}}}(),e="http://stackfiddle.com/",f=e+"css/stack-fiddle.css",g=e+"js/jquery.simplemodal.min.js",h="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js";d.css(f);var i=function(){d.js(g,a.init)};!window.hasOwnProperty("jQuery")||!c(window.jQuery.fn.jquery,"1.4.4")?d.js(h,i):i()}()})()